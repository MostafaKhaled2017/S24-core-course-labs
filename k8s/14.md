## Components of the Kube Prometheus Stack

The Kube Prometheus Stack is an open-source collection of resources that provides essential monitoring capabilities for Kubernetes clusters. It leverages several components from the Cloud Native Computing Foundation (CNCF) ecosystem, each serving specific roles to enhance the observability and reliability of services running on Kubernetes. Here's an overview of each major component and its function within the stack:

### 1. **Prometheus**
Prometheus is the heart of the monitoring stack, responsible for collecting and storing metrics data. It scrapes metrics from configured targets at specified intervals, evaluates rule expressions, displays the results, and triggers alerts if certain conditions are met.

### 2. **Alertmanager**
Alertmanager handles alerts sent by client applications such as Prometheus. It is responsible for deduplicating, grouping, and routing them to the correct receiver integrations such as email, PagerDuty, or OpsGenie. It also manages silencing and inhibition of alerts.

### 3. **Grafana**
Grafana is an analytics and visualization web application that allows you to create, explore, and share dashboards that display metrics data collected from various data sources like Prometheus. Grafana in the Kube Prometheus Stack is pre-configured with dashboards and data sources to visualize metrics from Kubernetes clusters effectively.

### 4. **Prometheus Node Exporter**
Node Exporter is a Prometheus exporter for hardware and OS metrics exposed by *NIX kernels, with pluggable metric collectors. It allows you to measure various machine resources such as memory, disk, and CPU utilization.

### 5. **kube-state-metrics**
kube-state-metrics is a simple service that listens to the Kubernetes API server and generates metrics about the state of the objects (e.g., deployments, pods, nodes) inside the cluster. This information is used by Prometheus to keep track of the various resources.

### 6. **Prometheus Operator**
The Prometheus Operator provides Kubernetes native deployment and management of Prometheus and related monitoring components. The operator includes features like automatic configuration of Prometheus instances and a set of CRDs (Custom Resource Definitions) to manage Prometheus, Alertmanager, and related resources.

### 7. **Prometheus Adapter**
Prometheus Adapter is an implementation of the Kubernetes Resource Metrics API and Custom Metrics API using Prometheus as a backend. This adapter enables autoscaling based on metrics available in Prometheus, integrating with Kubernetes' Horizontal Pod Autoscaler.

The integration of these components provides a robust framework for monitoring the performance and health of Kubernetes clusters, ensuring that developers and operators can observe and respond to their cluster's state in real time.

## Helm Chart Installation
```
$ kubectl get po,sts,svc,pvc,cm
NAME                                                                  READY   STATUS    RESTARTS   AGE
pod/alertmanager-prometheus-my-helm-app-pyt-alertmanager-0            2/2     Running   0          19m
pod/app-python-app-python-0                                           1/1     Running   0          115s
pod/app-python-app-python-1                                           1/1     Running   0          115s
pod/prometheus-my-helm-app-pyt-operator-8588d97b46-5gzqr              1/1     Running   0          6m14s
pod/prometheus-my-helm-app-python-grafana-6454d9f9f-9sqf2             3/3     Running   0          6m14s
pod/prometheus-my-helm-app-python-kube-state-metrics-787f48966f4xl    1/1     Running   0          6m14s
pod/prometheus-my-helm-app-python-prometheus-node-exporter-mzw9k      1/1     Running   0          6m14s
pod/prometheus-prometheus-my-helm-app-pyt-prometheus-0                2/2     Running   0          6m59s

NAME                                                                    READY   AGE
statefulset.apps/alertmanager-prometheus-my-helm-app-pyt-alertmanager   1/1     6m59s
statefulset.apps/app-python-app-python                                  2/2     115s
statefulset.apps/prometheus-prometheus-my-helm-app-pyt-prometheus       1/1     6m59s

NAME                                                             TYPE           CLUSTER-IP       EXTERNAL-IP   PORT(S)                      AGE
service/alertmanager-operated                                    ClusterIP      None             <none>        9093/TCP,9094/TCP,9094/UDP   19m
service/app-python-app-python                                    LoadBalancer   10.108.234.64    <pending>     5000:30951/TCP               115s
service/kubernetes                                               ClusterIP      10.96.0.1        <none>        443/TCP                      21m
service/prometheus-my-helm-app-pyt-alertmanager                  ClusterIP      10.107.137.19    <none>        9093/TCP,8080/TCP            19m
service/prometheus-my-helm-app-pyt-operator                      ClusterIP      10.97.228.43     <none>        443/TCP                      19m
service/prometheus-my-helm-app-pyt-prometheus                    ClusterIP      10.108.82.205    <none>        9090/TCP,8080/TCP            19m
service/prometheus-my-helm-app-python-grafana                    ClusterIP      10.105.178.30    <none>        80/TCP                       19m
service/prometheus-my-helm-app-python-kube-state-metrics         ClusterIP      10.111.96.29     <none>        8080/TCP                     19m
service/prometheus-my-helm-app-python-prometheus-node-exporter   ClusterIP      10.101.99.125    <none>        9100/TCP                     19m
service/prometheus-operated                                      ClusterIP      None             <none>        9090/TCP                     19m

NAME                                                        STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE
persistentvolumeclaim/Data-app-python-helm-app-python-0     Bound    pvc-11feca6b-be84-4789-86f7-c81f5ec96ad5   2Gi        RWO            standard       115s
persistentvolumeclaim/Data-app-python-helm-app-python-1     Bound    pvc-072999ba-a7e7-4944-a4aa-343e1ed65d4b   2Gi        RWO            standard       115s

NAME                                                                     DATA   AGE
configmap/kube-root-ca.crt                                               1      115s
configmap/prometheus-my-helm-app-pyt-alertmanager-overview               1      6m16s
configmap/prometheus-my-helm-app-pyt-apiserver                           1      6m16s
configmap/prometheus-my-helm-app-pyt-cluster-total                       1      6m16s
configmap/prometheus-my-helm-app-pyt-controller-manager                  1      6m16s
configmap/prometheus-my-helm-app-pyt-etcd                                1      6m16s
configmap/prometheus-my-helm-app-pyt-grafana-datasource                  1      6m16s
configmap/prometheus-my-helm-app-pyt-grafana-overview                    1      6m16s
configmap/prometheus-my-helm-app-pyt-k8s-coredns                         1      6m16s
configmap/prometheus-my-helm-app-pyt-k8s-resources-cluster               1      6m16s
configmap/prometheus-my-helm-app-pyt-k8s-resources-multicluster          1      6m16s
configmap/prometheus-my-helm-app-pyt-k8s-resources-namespace             1      6m16s
configmap/prometheus-my-helm-app-pyt-k8s-resources-node                  1      6m16s
configmap/prometheus-my-helm-app-pyt-k8s-resources-pod                   1      6m16s
configmap/prometheus-my-helm-app-pyt-k8s-resources-workload              1      6m16s
configmap/prometheus-my-helm-app-pyt-k8s-resources-workloads-namespace   1      6m16s
configmap/prometheus-my-helm-app-pyt-kubelet                             1      6m16s
configmap/prometheus-my-helm-app-pyt-namespace-by-pod                    1      6m16s
configmap/prometheus-my-helm-app-pyt-namespace-by-workload               1      6m16s
configmap/prometheus-my-helm-app-pyt-node-cluster-rsrc-use               1      6m16s
configmap/prometheus-my-helm-app-pyt-node-rsrc-use                       1      6m16s
configmap/prometheus-my-helm-app-pyt-nodes                               1      6m16s
configmap/prometheus-my-helm-app-pyt-nodes-darwin                        1      6m16s
configmap/prometheus-my-helm-app-pyt-persistentvolumesusage              1      6m16s
configmap/prometheus-my-helm-app-pyt-pod-total                           1      6m16s
configmap/prometheus-my-helm-app-pyt-prometheus                          1      6m16s
configmap/prometheus-my-helm-app-pyt-proxy                               1      6m16s
configmap/prometheus-my-helm-app-pyt-scheduler                           1      6m16s
configmap/prometheus-my-helm-app-pyt-workload-total                      1      6m16s
configmap/prometheus-my-helm-app-python-grafana                          1      6m16s
configmap/prometheus-my-helm-app-python-grafana-config-dashboards        1      6m16s
configmap/prometheus-prometheus-my-helm-app-pyt-prometheus-rulefiles-0   35     6m16s
configmap/py-configmap                                                   1      115s
```

## Init Containers
```
$ kubectl exec statefulset.apps/app-python-app-python -- head -n 5 /work-dir/index.html
Defaulted container "app-python" out of: app-python, get-page (init)
<html><head></head><body><header>
<title>http://info.cern.ch</title>
</header>
<h1>http://info.cern.ch - home of the first website</h1>
```